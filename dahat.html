<!DOCTYPE html>
<html lang="ku">
<head>
<meta charset="UTF-8">
<title>Ø³ÛŒØ³ØªÛ•Ù…ÛŒ Ø­Ø³Ø§Ø¨Ø§ØªÛŒ Ù‚Ø§ÙˆÛ•Ø®Ø§Ù†Û•</title>
<style>
*{box-sizing:border-box;font-family:sans-serif}
body{background:#eef3ee;padding:20px}
.container{max-width:1300px;margin:auto;background:#fff;padding:20px;border-radius:15px}
h1{text-align:center;color:#2e7d32}
.hidden{display:none}
input,button,select{
 width:100%;padding:10px;margin-top:8px;border-radius:8px;border:1px solid #ccc
}
button{background:#2e7d32;color:#fff;border:none;cursor:pointer}
.card{background:#f9f9f9;padding:15px;border-radius:10px;margin-bottom:15px}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border-bottom:1px solid #ddd;padding:8px;text-align:center}
.summary{display:flex;gap:10px}
.summary div{flex:1;background:#eaf5ea;padding:10px;border-radius:10px;text-align:center}
.green{color:green;font-weight:bold}
.red{color:red;font-weight:bold}
</style>
</head>

<body>
<div class="container">
<h1>â˜• Ø³ÛŒØ³ØªÛ•Ù…ÛŒ Ø­Ø³Ø§Ø¨Ø§ØªÛŒ Ù‚Ø§ÙˆÛ•Ø®Ø§Ù†Û•</h1>

<!-- LOGIN -->
<div id="loginBox" class="card">
<h3>Ú†ÙˆÙˆÙ†Û•Ú˜ÙˆÙˆØ±Û•ÙˆÛ•</h3>
<input id="username" placeholder="Username">
<input id="password" type="password" placeholder="Password">
<button onclick="login()">Ú†ÙˆÙˆÙ†Û•Ú˜ÙˆÙˆØ±Û•ÙˆÛ•</button>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="hidden">

<p><b>ğŸ‘¤ Ø¦Û•Ú©Ø§ÙˆÙ†Øª:</b> <span id="roleText"></span></p>

<!-- NOTIFICATION -->
<div id="notifyBox" class="card hidden">
ğŸ”” <b>Ø¦Ø§Ú¯Ø§Ø¯Ø§Ø±ÛŒ Ù†ÙˆÛ</b>
<ul id="notifyList"></ul>
</div>

<!-- ADD -->
<div class="card">
<h3>â• Ø¯Ø§Ø®ÚµÚ©Ø±Ø¯Ù†</h3>
<select id="type">
<option value="income">Ø¯Ø§Ù‡Ø§Øª</option>
<option value="expense">Ø®Û•Ø±Ø¬ÛŒ</option>
</select>
<input id="amount" type="number" placeholder="Ø¨Ú•ÛŒ Ù¾Ø§Ø±Û•">
<input id="note" placeholder="ØªÛØ¨ÛŒÙ†ÛŒ (Ù¾ÛÙˆÛŒØ³ØªÛ• Ø¨Û† Ø®Û•Ø±Ø¬ÛŒ)">
<button onclick="addEntry()">Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†</button>
</div>

<!-- SUMMARY OWNER -->
<div id="summary" class="summary hidden">
<div>
<h4>Ú©Û†ÛŒ Ø¯Ø§Ù‡Ø§Øª</h4>
<div id="totalIncome">0</div>
</div>
<div>
<h4>Ú©Û†ÛŒ Ø®Û•Ø±Ø¬ÛŒ</h4>
<div id="totalExpense">0</div>
</div>
<div>
<h4>Ù‚Ø§Ø²Ø§Ù†Ø¬</h4>
<div id="profit">0</div>
</div>
</div>

<!-- REPORT -->
<div class="card">
<h3>ğŸ“Š Ú•Ø§Ù¾Û†Ø±Øª</h3>
<select id="filter" onchange="render()">
<option value="today">Ø¦Û•Ù…Ú•Û†</option>
<option value="month">Ø¦Û•Ù… Ù…Ø§Ù†Ú¯Û•</option>
<option value="all">Ù‡Û•Ù…ÙˆÙˆ</option>
</select>

<table id="table">
<tr>
<th>Ø¬Û†Ø±</th><th>Ø¨Ú•</th><th>ØªÛØ¨ÛŒÙ†ÛŒ</th><th>Ú©Û•ÛŒ</th><th>Ù„Û• Ù„Ø§ÛŒÛ•Ù†</th><th>Ú©Ø±Ø¯Ø§Ø±</th>
</tr>
</table>
</div>

<button onclick="sendDailyReport()">ğŸ“¤ Ù†Ø§Ø±Ø¯Ù†ÛŒ Ú•Ø§Ù¾Û†Ø±ØªÛŒ Ø¦Û•Ù…Ú•Û† Ø¨Û† Telegram</button>
<button onclick="logout()">Ú†ÙˆÙˆÙ†Û•Ø¯Û•Ø±Û•ÙˆÛ•</button>

</div>
</div>

<script>
/* ğŸ” LOGIN USERS */
const users={
 admin:{pass:"zand2026",role:"zand"},
 staff:{pass:"1111",role:"staff"}
};

/* ğŸ”” TELEGRAM */
const TELEGRAM_TOKEN="8332902614:AAGa1G-wf-GUvlyaS1w9-6wVwesQhfrwye4";
const TELEGRAM_CHAT_ID="5984127203";

function sendTelegram(msg){
 fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`,{
  method:"POST",
  headers:{"Content-Type":"application/json"},
  body:JSON.stringify({chat_id:TELEGRAM_CHAT_ID,text:msg})
 });
}

/* ğŸ“¦ DATA */
let currentUser=null;
let data=JSON.parse(localStorage.getItem("data"))||[];
let notifications=JSON.parse(localStorage.getItem("notify"))||[];

/* ğŸ” LOGIN */
function login(){
 const u=username.value,p=password.value;
 if(!users[u]||users[u].pass!==p) return alert("Ù‡Û•ÚµÛ•ÛŒÛ•");
 currentUser={name:u,role:users[u].role};
 loginBox.classList.add("hidden");
 dashboard.classList.remove("hidden");
 roleText.innerText=currentUser.role;
 if(currentUser.role==="owner"){
  summary.classList.remove("hidden");
  showNotifications();
  sendDailyReport();
 }
 render();
}

function logout(){location.reload()}

/* â• ADD */
function addEntry(){
 const t=type.value;
 const a=Number(amount.value);
 const n=note.value;

 if(!a) return;
 if(t==="expense"&&!n) return alert("ØªÛØ¨ÛŒÙ†ÛŒ Ø®Û•Ø±Ø¬ÛŒ Ù¾ÛÙˆÛŒØ³ØªÛ•");

 data.push({
  type:t,amount:a,note:n,
  date:new Date().toISOString(),
  user:currentUser.name
 });
 localStorage.setItem("data",JSON.stringify(data));

 if(currentUser.role==="staff"){
  const msg=
   "â˜• Ø¯Ø§Ø®ÚµÚ©Ø±Ø¯Ù†ÛŒ Ù†ÙˆÛ\n"+
   "ğŸ‘¤ "+currentUser.name+"\n"+
   "ğŸ“Œ "+(t==="income"?"Ø¯Ø§Ù‡Ø§Øª":"Ø®Û•Ø±Ø¬ÛŒ")+"\n"+
   "ğŸ’° "+a+"\n"+
   "ğŸ§¾ "+(n||"-");
  notifications.push(msg);
  localStorage.setItem("notify",JSON.stringify(notifications));
  sendTelegram(msg);
 }

 amount.value="";note.value="";
 render();
}

/* ğŸ“Š RENDER */
function render(){
 table.innerHTML="<tr><th>Ø¬Û†Ø±</th><th>Ø¨Ú•</th><th>ØªÛØ¨ÛŒÙ†ÛŒ</th><th>Ú©Û•ÛŒ</th><th>Ù„Û• Ù„Ø§ÛŒÛ•Ù†</th><th>Ú©Ø±Ø¯Ø§Ø±</th></tr>";
 let ti=0,te=0;
 const now=new Date();

 data.forEach((d,i)=>{
  const dt=new Date(d.date);
  if(filter.value==="today"&&dt.toDateString()!==now.toDateString())return;
  if(filter.value==="month"&&(dt.getMonth()!==now.getMonth()||dt.getFullYear()!==now.getFullYear()))return;

  if(d.type==="income")ti+=d.amount;
  if(d.type==="expense")te+=d.amount;

  let act="";
  if(currentUser.role==="owner") act=`<button onclick="del(${i})">Ø³Ú•ÛŒÙ†Û•ÙˆÛ•</button>`;

  table.innerHTML+=`
  <tr>
   <td>${d.type}</td>
   <td>${d.amount}</td>
   <td>${d.note||""}</td>
   <td>${dt.toLocaleString()}</td>
   <td>${d.user}</td>
   <td>${act}</td>
  </tr>`;
 });

 if(currentUser.role==="owner"){
  totalIncome.innerText=ti;
  totalExpense.innerText=te;
  profit.innerText=ti-te;
  profit.className=(ti-te)>=0?"green":"red";
 }
}

function del(i){
 if(!confirm("Ø¯ÚµÙ†ÛŒØ§ÛŒØªØŸ"))return;
 data.splice(i,1);
 localStorage.setItem("data",JSON.stringify(data));
 render();
}

/* ğŸ”” NOTIFY */
function showNotifications(){
 if(notifications.length===0)return;
 notifyBox.classList.remove("hidden");
 notifyList.innerHTML="";
 notifications.forEach(n=>notifyList.innerHTML+=`<li>${n}</li>`);
 notifications=[];
 localStorage.setItem("notify","[]");
}

/* ğŸ“¤ DAILY REPORT */
function sendDailyReport(){
 const today=new Date().toDateString();
 let i=0,e=0;
 data.forEach(d=>{
  if(new Date(d.date).toDateString()===today){
   if(d.type==="income")i+=d.amount;
   if(d.type==="expense")e+=d.amount;
  }
 });
 sendTelegram(
  "â˜• Ú•Ø§Ù¾Û†Ø±ØªÛŒ Ú•Û†Ú˜ÛŒ Ù‚Ø§ÙˆÛ•Ø®Ø§Ù†Û•\n"+
  "ğŸ“… "+new Date().toLocaleDateString()+"\n\n"+
  "ğŸ’° Ø¯Ø§Ù‡Ø§Øª: "+i+"\n"+
  "ğŸ’¸ Ø®Û•Ø±Ø¬ÛŒ: "+e+"\n"+
  "ğŸ“ˆ Ù‚Ø§Ø²Ø§Ù†Ø¬: "+(i-e)
 );
}
</script>
</body>
</html>
